<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Organisk Metallisk VÃ¦sen</title>
<style>
body,html{margin:0;overflow:hidden;height:100vh;width:100vw;background-color:black}
canvas{display:block;width:100vw;height:100vh}
</style>
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
camera.rotation.z=Math.PI/2;
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);
const pointLight=new THREE.PointLight(0xff0000,3);camera.add(pointLight);scene.add(camera);
const armMaterial=new THREE.MeshStandardMaterial({color:0xff0000,metalness:1,roughness:0.3});
const armGeometry=new THREE.CylinderGeometry(0.05,0.3,7,32),arms=[],armCount=80;
for(let i=0;i<armCount;i++){
    const arm=new THREE.Mesh(armGeometry,armMaterial),angle=(i/armCount)*Math.PI*2;
    arm.position.set(0,Math.cos(angle)*3,Math.sin(angle)*3);
    arm.rotation.x=Math.PI/2;arm.rotation.z=angle;scene.add(arm);arms.push(arm);
}
camera.position.x=20;
let analyser,dataArray;
navigator.mediaDevices.getUserMedia({audio:true,video:false})
.then(stream=>{
    const audioContext=new(window.AudioContext||window.webkitAudioContext)();
    const source=audioContext.createMediaStreamSource(stream);
    analyser=audioContext.createAnalyser();analyser.fftSize=256;
    source.connect(analyser);dataArray=new Uint8Array(analyser.frequencyBinCount);
})
.catch(err=>console.log('Lydinput fejlede:',err));
function animate(){
    requestAnimationFrame(animate);
    if(analyser){
        analyser.getByteFrequencyData(dataArray);
        arms.forEach((arm,i)=>{
            const freq=dataArray[i%dataArray.length],scale=1+freq*0.02;
            arm.scale.y=scale;
            arm.rotation.y+=0.02*(freq*0.02);
            arm.rotation.z+=0.03*(freq*0.01);
            arm.material.color.setHSL(0,1,0.5+(freq/255)*0.5);
        });
    }
    renderer.render(scene,camera);
}
animate();
window.addEventListener('resize',()=>{
    renderer.setSize(window.innerWidth,window.innerHeight);
    camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();
});
document.addEventListener('click',()=>{
    if(!document.fullscreenElement)document.documentElement.requestFullscreen();
});
</script>
</body>
</html>
